<div class="show-contextual-tooltip">
  <input recipe-blink="'pattern_name_input_box'" class="span6" ng-change="indexChanged()" ng-model="fileIndex.name"/>
  <recipe-tooltip rt-id="'pattern_name_input_box'"></recipe-tooltip>

  <div class="help-tooltip contextual-tooltip">Change the pattern name</div>
</div>
<div class="pattern-main-window">
  <div class="row-fluid">
    <div class="span6">
      <div class="row-fluid">
          <div class="span6">
            <p class="serie-label">Measure beats</p>
          </div>
          <div class="span2 show-contextual-tooltip">
            <input type="number" class="smallinput" min=1 max=50 ng-model="file.measure" ng-change="fileChanged()"/>

            <div class="help-tooltip contextual-tooltip">Amount of beats per measure</div>
          </div>

      </div>
      <div class="row-fluid">
          <div class="span6">
            <p class="serie-label">Measure count</p>
          </div>
          <div class="span2 show-contextual-tooltip">
            <p class="serie-label">{{file.measureCount}}</p>
            <div class="help-tooltip contextual-tooltip">Total count of measures on pattern</div>
          </div>
      </div>
      <div class="row-fluid">
          <div class="span6">
            <p class="serie-label">Zoom level</p>
          </div>
          <div class="span2 show-contextual-tooltip">
            <input type="number" class="smallinput" min=1 max=32 ng-model="zoomLevel"/>
            <div class="help-tooltip contextual-tooltip">Zoom level for all tracks</div>
          </div>
      </div>
    </div>
    <div class="span6 player-controls pull-right">
      <div class="row-fluid">
        <button recipe-blink="'pattern_play'" class="player btn btn-primary show-contextual-tooltip" ng-click="play(); recipe.raise('pattern_play_click')">
          Play
          <recipe-tooltip rt-id="'pattern_play'"></recipe-tooltip>
          <div class="help-tooltip contextual-tooltip cap-right">Click to play the pattern</div>
        </button>
        <button class="player btn btn-primary show-contextual-tooltip" ng-click="stop()">
          Stop
          <div class="help-tooltip contextual-tooltip">Click to stop playing</div>
        </button>
      </div>
      <div class="row-fluid"> 
          <div class="span1 pull-right"></div>
          <div class="span3 pull-right show-contextual-tooltip">
            <input type="number" class="smallinput" min=1 ng-model="file.bpm"  ng-change="fileChanged()"/>
            <div class="help-tooltip contextual-tooltip cap-right">Playing speed, number of beats per minute</div>
          </div>
          <div class="span2 pull-right">
            <p class="serie-label">Bpm</p>
          </div>
      </div>
    </div>
  </div>

  <hr class="soften"></hr>

  <h1>Tracks</h1>


  <div ng-repeat="track in file.tracks">
    <div class="row-fluid">
      <div class="vertical-margin span2 show-contextual-tooltip">
        <button ng-click="removeTrack($index)" class="btn btn-primary">Remove</button>
        <div class="help-tooltip contextual-tooltip">Click to remove track</div>
      </div>
      <div class="vertical-margin span10 show-contextual-tooltip">
        <div class="track-compact-view-wrapper" ng-class="{selected: file.selectedTrack === $index}"
            ng-click="file.selectedTrack = $index">
          <pattern-track-compact-view
            measure-count="file.measureCount"
            measure="file.measure"
            track="file.tracks[$index]"
            beat-width="beatWidth"
            zoom-level="zoomLevel"></pattern-track-compact-view>
        </div>

        <div class="help-tooltip contextual-tooltip">Track compact view: see the notes without having to expand the track.<br/> Click here to expand the track</div>
      </div>
    </div>
    <div class="row-fluid" ng-if="file.selectedTrack == $index" ng-class="{'enabled-instrument': file.tracks[file.selectedTrack].instrument}" >
        <div class="span2 show-contextual-tooltip">
        <!-- Instrument drop zone -->
            <div recipe-blink="'pattern_instrument_dropzone'" class="pattern-drop-lateral" ng-drop="true" ng-drop-success="onDropComplete($data,$event); recipe.raise('instrument_dropped')">
              <span ng-show="file.tracks[file.selectedTrack].instrument" class="fa fa-keyboard-o"></span>
              <p>{{file.tracks[file.selectedTrack].instrument ? file.tracks[file.selectedTrack].instrument.name : "drop instrument here" }}</p>
              <recipe-tooltip rt-id="'pattern_instrument_dropzone'"></recipe-tooltip>
            </div>

             <div class="help-tooltip contextual-tooltip">Instrument drop zone, drop instruments from the left panel to use it on the track</div>
        </div>  

        <div class="span10 show-contextual-tooltip">
          <music-event-editor 
            measure-count="file.measureCount"
            measure="file.measure"
            track="file.tracks[file.selectedTrack]"
            beat-width="beatWidth"
            zoom-level="zoomLevel"
            recipe="recipe"></music-event-editor>

          <recipe-tooltip rt-id="'pattern_track_event_area'"></recipe-tooltip>

          <div class="help-tooltip contextual-tooltip long-tooltip">
            Note area, add the notes here:
            <br/>
            * Click to add a new one, and drag to change value/time
            <br/>
            * CTRL+Z to undo changes
            <br/>
            * CTRL+Y to redo changes
          </div>
        </div>
    </div>
  </div>

  <div class="row-fluid margin-top-20">
    <div class="span2 show-contextual-tooltip">
      <button ng-click="addTrack()" class="btn btn-primary">Add</button>

      <div class="help-tooltip contextual-tooltip">Click this button to add new empty tracks</div>
    </div>
  </div>


</div>